function add(a, b) {
    return a + b;
}

function subtract(a, b) {
    return a - b;
} 

function multiply(a, b) {
    return a * b;
}

function divide(a, b) {
    if (b === 0) {
        throw new Error("Division by zero");
    }

    return a / b;
}

function operate(firstNumber, secondNumber, operator) {
    if (operator === "+") {
        return add(firstNumber, secondNumber);
    } else if (operator === "-") {
        return subtract(firstNumber, secondNumber);
    } else if (operator === "*") {
        return multiply(firstNumber, secondNumber);
    } else if (operator === "/") {
        return divide(firstNumber, secondNumber);
    }
}

const operations = {
    "+": true,
    "-": true,
    "*": true,
    "/": true,
};

let firstNumber = "";
let operation = "";
let secondNumber = "";

let displayValue = "";
const output = document.querySelector(".output");

function clearValues() {
    firstNumber = "";
    operation = "";
    secondNumber = "";
}

function readValues() {
    const text = output.innerText;
    let i = 0;
    while(isNaN(+text[i]) === false) {
        firstNumber += text[i++];
    }

    if (firstNumber === "") return false;

    while (operations[text[i]]) i++;

    if (operations[text[i-1]]) {
        operation = text[i-1];
    } else {
        return false;
    }

    while (isNaN(+text[i]) === false) {
        secondNumber += text[i++];
    }

    if (secondNumber === "") return false;

    return true;
}

document.querySelectorAll("button:not(.clear):not(.equals)").forEach((button) => {
        button.addEventListener("click", (e) => {
        const value = e.target.textContent;
        
        output.innerText += value;
        displayValue += value;
    })
});

document.querySelector(".clear").addEventListener("click", () => {
    clearValues();
    output.innerText = "";
});

document.querySelector(".equals").addEventListener("click", () => {
    clearValues();    
    const state = readValues();

    console.log(state);
    console.log(firstNumber, operation, secondNumber);

    operate(firstNumber, operation, secondNumber);
});
